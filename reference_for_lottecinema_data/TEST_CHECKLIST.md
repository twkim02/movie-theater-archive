# 🧪 롯데시네마 통합 테스트 체크리스트

이 문서는 1단계와 2단계 작업을 테스트할 때 확인해야 하는 항목들을 정리합니다.

---

## 📱 테스트 화면에서 확인할 항목

### 접근 방법
1. 앱 실행
2. 탐색 탭의 우측 상단 버그 아이콘 클릭 (또는 TestScreen으로 직접 이동)
3. "롯데시네마" 탭 선택

---

## ✅ 1. CSV 파서 테스트

### 1.1. 현재 상영 중인 영화 목록
- **확인 항목**: 
  - ✅ 목록이 비어있지 않아야 함
  - ✅ 개수가 표시되어야 함 (예: "48개")
- **예상 결과**: 
  - 현재 상영 중인 영화가 48개 정도 표시되어야 함
  - `assets/lottecinema/movie_now.csv` 파일의 데이터와 일치해야 함

### 1.2. 영화관 목록
- **확인 항목**:
  - ✅ 목록이 비어있지 않아야 함
  - ✅ 개수가 표시되어야 함 (예: "136개")
- **예상 결과**:
  - 영화관이 136개 정도 표시되어야 함
  - `assets/lottecinema/theater.csv` 파일의 데이터와 일치해야 함

### 1.3. 영화관 검색 (대전센트럴)
- **확인 항목**:
  - ✅ "대전센트럴" 영화관을 찾을 수 있어야 함
  - ✅ 영화관 이름이 표시되어야 함
- **예상 결과**:
  - "대전센트럴" 또는 "대전"이 포함된 영화관 이름이 표시되어야 함
  - cinemaIdString이 "1|0003|4008" 형식이어야 함

---

## ✅ 2. 영화 제목 매칭 테스트

### 2.1. 정확한 매칭 (만약에 우리)
- **확인 항목**:
  - ✅ "만약에 우리" 영화를 찾을 수 있어야 함
  - ✅ 영화명이 정확히 표시되어야 함
- **예상 결과**:
  - "만약에 우리" 영화가 찾아지고, movieNo가 "23663"이어야 함

### 2.2. 부분 매칭 (아바타)
- **확인 항목**:
  - ✅ "아바타"로 검색했을 때 "아바타: 불과 재"를 찾을 수 있어야 함
- **예상 결과**:
  - "아바타: 불과 재" 영화가 찾아지고, movieNo가 "23649"이어야 함

### 2.3. 상영 여부 확인
- **확인 항목**:
  - ✅ "만약에 우리"가 현재 상영 중인지 확인
- **예상 결과**:
  - "상영 중" 또는 "상영 안 함"이 표시되어야 함
  - `movie_now.csv`에 있으면 "상영 중"이어야 함

---

## ✅ 3. 롯데시네마 API 클라이언트 테스트

### 3.1. 상영 시간표 가져오기 버튼
- **확인 항목**:
  - ✅ 버튼을 클릭하면 로딩 화면이 표시되어야 함
  - ✅ 성공 시 상영 시간표가 표시되어야 함
  - ✅ 실패 시 적절한 에러 메시지가 표시되어야 함

### 3.2. 실제 API 호출 테스트
**주의**: 이 테스트는 실제 네트워크 연결이 필요하며, 롯데시네마 서버 상태에 따라 결과가 달라질 수 있습니다.

**테스트 시나리오**:
1. 버튼 클릭: "상영 시간표 가져오기 (대전센트럴, 만약에 우리)"
2. 로딩 화면 확인
3. 결과 확인:
   - **성공 시**: 
     - 상영 시간표 다이얼로그가 표시됨
     - **오늘 날짜**와 **내일 날짜** 두 섹션으로 구분되어 표시됨
     - 각 섹션에 날짜가 표시됨 (예: "📅 2026-01-13 (오늘)", "📅 2026-01-14 (내일)")
     - 각 상영 시간표에 시작 시간, 종료 시간, 상영관, 잔여 좌석 수가 표시됨
     - 예: "17:30 ~ 19:34 | 4관 | 잔여: 150/200석"
     - 성공 메시지에 총 개수와 오늘/내일 개수가 표시됨 (예: "총 5개의 상영 시간표를 가져왔습니다! (오늘: 3개, 내일: 2개)")
   - **실패 시**:
     - 에러 메시지가 표시됨
     - 가능한 원인:
       - 네트워크 연결 오류
       - 해당 날짜에 상영하지 않음
       - API 서버 오류
       - 영화관 또는 영화 정보가 변경됨

**예상 결과**:
- 오늘과 내일 날짜에 "만약에 우리"가 대전센트럴에서 상영 중이라면 각각의 상영 시간표가 표시되어야 함
- 오늘만 상영하거나 내일만 상영하는 경우에도 해당 날짜의 상영 시간표가 표시되어야 함
- 둘 다 상영하지 않거나 네트워크 오류가 있으면 적절한 메시지가 표시되어야 함

---

## 🔍 추가 확인 사항

### CSV 파일 로딩 확인
- **확인 방법**: 앱을 처음 실행할 때 CSV 파일이 제대로 로드되는지 확인
- **확인 항목**:
  - ✅ 앱이 크래시하지 않아야 함
  - ✅ 테스트 화면에서 데이터가 표시되어야 함

### 캐싱 동작 확인
- **확인 방법**: 같은 데이터를 여러 번 요청했을 때
- **확인 항목**:
  - ✅ 두 번째 요청부터는 빠르게 로드되어야 함 (캐싱 효과)
  - ✅ 데이터가 일관되게 표시되어야 함

### 에러 처리 확인
- **확인 방법**: 네트워크를 끊고 API 호출 테스트
- **확인 항목**:
  - ✅ 앱이 크래시하지 않아야 함
  - ✅ 적절한 에러 메시지가 표시되어야 함
  - ✅ 빈 리스트를 반환해야 함

---

## 📝 테스트 결과 기록

### 성공 기준
- ✅ 모든 CSV 파서 테스트 통과
- ✅ 모든 영화 제목 매칭 테스트 통과
- ✅ API 클라이언트가 에러 없이 동작 (실제 API 호출 성공 여부는 서버 상태에 따라 다를 수 있음)

### 실패 시 확인 사항
1. **CSV 파일이 로드되지 않는 경우**:
   - `pubspec.yaml`에 `assets/lottecinema/` 경로가 추가되었는지 확인
   - `flutter pub get` 실행
   - 앱 재시작

2. **영화 제목 매칭이 실패하는 경우**:
   - CSV 파일의 영화명과 TMDb 제목이 일치하는지 확인
   - 매칭 로직이 제대로 작동하는지 디버그 로그 확인

3. **API 호출이 실패하는 경우**:
   - 네트워크 연결 확인
   - 롯데시네마 서버 상태 확인
   - 영화관 ID와 영화 번호가 올바른지 확인
   - 에러 메시지 확인

---

## 🎯 다음 단계로 넘어가기 전 확인

다음 항목들이 모두 확인되면 3단계로 진행할 수 있습니다:

- [ ] CSV 파서가 모든 데이터를 올바르게 로드함
- [ ] 영화 제목 매칭이 정확하게 작동함
- [ ] API 클라이언트가 에러 없이 동작함 (실제 API 호출 성공 여부는 선택사항)
- [ ] 에러 처리가 적절하게 작동함
- [ ] 테스트 화면에서 모든 기능이 정상적으로 표시됨

---

## ✅ 4. 상영 시간표 서비스 테스트 (3단계)

### 4.1. 롯데시네마 상영 시간표 가져오기
- **확인 항목**:
  - ✅ 롯데시네마 영화관으로 요청 시 상영 시간표를 가져올 수 있어야 함
  - ✅ 개수가 표시되어야 함 (0개 이상)
- **예상 결과**:
  - 실제 API 호출이 시도되고, 성공하면 상영 시간표가 표시됨
  - 실패해도 빈 리스트를 반환하고 에러가 발생하지 않아야 함

### 4.2. CGV 영화관 (롯데시네마 아님)
- **확인 항목**:
  - ✅ 롯데시네마가 아닌 영화관은 빈 리스트를 반환해야 함
- **예상 결과**:
  - "빈 리스트 (정상)" 메시지가 표시되어야 함

### 4.3. 실제 앱에서 테스트
**테스트 시나리오**:
1. 탐색 탭에서 상영 중인 영화 선택 (예: "만약에 우리")
2. "영화관 보기" 버튼 클릭
3. 주변 영화관 목록 확인:
   - **롯데시네마 영화관**: 
     - 상영 시간표가 칩 형태로 표시되어야 함
     - 예: "17:30~19:34 · 4관"
     - 여러 개의 상영 시간표가 있으면 모두 표시되어야 함
   - **다른 영화관 (CGV, 메가박스 등)**:
     - "시간표는 예매/시간표에서 확인할 수 있어요." 메시지 표시
     - 하이퍼링크 버튼만 표시

**예상 결과**:
- 롯데시네마 영화관에서만 실제 상영 시간표가 표시됨
- 다른 영화관은 기존처럼 하이퍼링크만 제공됨
- 네트워크 오류나 상영 시간표가 없어도 앱이 크래시하지 않아야 함

---

---

## ✅ 5. 롯데시네마 상영 여부 확인 테스트 (4단계)

### 5.1. 롯데시네마 상영 여부 확인
- **확인 항목**:
  - ✅ 롯데시네마에서 상영 중인 영화는 true를 반환해야 함
  - ✅ 상영하지 않는 영화는 false를 반환해야 함
- **예상 결과**:
  - "만약에 우리"는 상영 중이므로 true (또는 false, CSV 데이터에 따라 다를 수 있음)
  - "존재하지 않는 영화"는 false

### 5.2. TMDb 초기화 통합 테스트
**테스트 시나리오**:
1. 테스트 화면의 "DB 테스트" 탭으로 이동
2. "TMDb API에서 영화 가져오기" 버튼 클릭
3. 초기화 완료 후 탐색 탭으로 이동
4. "최근 상영 중인 영화" 섹션 확인:
   - TMDb에서 상영 중이 아니지만 롯데시네마 CSV에 있는 영화가 포함되어 있는지 확인
   - 예: "아바타: 불과 재" 같은 영화가 롯데시네마 CSV에 있으면 "최근 상영 중인 영화"에 표시되어야 함

**예상 결과**:
- TMDb 초기화 시 롯데시네마 CSV를 확인하여 `isRecent` 플래그를 보완
- 롯데시네마에서 상영 중인 영화가 "최근 상영 중인 영화" 섹션에 표시됨

**주의사항**:
- 실제 TMDb API 호출이 필요하므로 네트워크 연결이 필요함
- 초기화에 시간이 걸릴 수 있음 (여러 영화의 상세 정보를 가져와야 함)

---

## ✅ 6. UI 통합 및 최적화 테스트 (5단계)

### 6.1. TheaterCard 위젯 테스트
- **확인 항목**:
  - ✅ 롯데시네마 영화관 카드에 "실시간 상영 시간표" 라벨이 표시되어야 함
  - ✅ 롯데시네마 상영 시간표 Chip이 파란색 배경으로 표시되어야 함
  - ✅ CGV 같은 다른 영화관은 라벨이 표시되지 않아야 함
  - ✅ 상영 시간표가 없으면 안내 메시지가 표시되어야 함
- **예상 결과**:
  - 롯데시네마 대전센트럴 카드에 "실시간 상영 시간표" 라벨과 파란색 Chip이 표시됨
  - CGV 대전 카드에는 라벨이 없고 안내 메시지만 표시됨

### 6.2. 캐시 관리 테스트
- **확인 항목**:
  - ✅ 캐시 통계가 올바르게 표시되어야 함 (전체, 유효, 만료 개수)
  - ✅ "만료된 캐시 정리" 버튼 클릭 시 만료된 캐시가 제거되어야 함
  - ✅ "캐시 전체 초기화" 버튼 클릭 시 모든 캐시가 제거되어야 함
  - ✅ 버튼 클릭 후 캐시 통계가 실시간으로 업데이트되어야 함
- **예상 결과**:
  - 캐시 통계가 "전체: X개, 유효: Y개, 만료: Z개" 형식으로 표시됨
  - 만료된 캐시 정리 후 유효 캐시 개수가 업데이트됨
  - 캐시 전체 초기화 후 전체 개수가 0이 됨

### 6.3. 에러 처리 테스트
- **확인 항목**:
  - ✅ 존재하지 않는 영화관으로 요청 시 빈 리스트를 반환해야 함
  - ✅ 롯데시네마가 아닌 영화관으로 요청 시 빈 리스트를 반환해야 함
  - ✅ 에러 발생 시 앱이 멈추지 않고 조용히 처리되어야 함
- **예상 결과**:
  - "존재하지 않는 영화관" 요청 시 빈 리스트 반환 (정상)
  - "CGV 대전" 요청 시 빈 리스트 반환 (정상)
  - 에러 메시지 없이 조용히 처리됨

**테스트 방법**:
1. 테스트 화면의 "롯데시네마" 탭으로 이동
2. "5. UI 통합 및 최적화 테스트" 섹션 확인
3. 각 테스트 항목을 순서대로 확인

---

**문서 작성일**: 2026년 1월  
**테스트 대상**: 1단계 (CSV 파싱) + 2단계 (API 클라이언트) + 3단계 (상영 시간표 통합) + 4단계 (TMDb 초기화 보완) + 5단계 (UI 통합 및 최적화)
